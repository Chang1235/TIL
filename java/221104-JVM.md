# 자바 가상머신 JVM

# JVM(Java Virtual Machine)이란?

자바 가상 머신 JVM은 자바 프로그램 실행환경을 만들어 주는 소프트웨어입니다.

자바 코드를 컴파일하여 .class 바이트 코드로 만들면 이 코드가 자바 가상 머신 환경에서 실행됩니다.

JVM은 자바 실행 환경 JRE(Java Runtime Environment)에 포함되어 있습니다.

현재 사용하는 컴퓨터의 운영체제에 맞는 자바 실행환경이 설치되어 있다면 자바 가상 머신이 설치되어 있다는 뜻입니다.

## JVM을 사용하면서 갖게되는 이점은?

<aside>
💡 하나의 바이트 코드(.class)로 모든 플랫폼에서 동작하도록 할 수 잇습니다.

</aside>

![스크린샷 2022-11-03 오후 2.54.43.png](%E1%84%8C%E1%85%A1%E1%84%87%E1%85%A1%20%E1%84%80%E1%85%A1%E1%84%89%E1%85%A1%E1%86%BC%E1%84%86%E1%85%A5%E1%84%89%E1%85%B5%E1%86%AB%20JVM%20c828a64ae0bd423ea55d8d8bf3daea47/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2022-11-03_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.54.43.png)

Java의 경우에는 Java 언어로 작성된 Tes.java는 컴파일하면 Test.class파일이 생성됩니다. 그리고 이렇게 생성된 바이트 코드는 각자의 플랫폼에 설치되어 있는 자바 가상 머신이 운영체제에 맞는 실행 파일로 바꿔줍니다. 즉 Java에서는 C언어와는 달리 JVM을 사용하기 때문에 **각자의 플랫폼에 맞게끔 컴파일을 따로따로 해줘야 할 필요가 없습니다.** 하나의 바이트 코드로 JVM이 설치되어 있는 모든 플랫폼에서 동작이 가능하다는 이야기입니다.

## 자바 프로그램의 실행과정과 JVM

![스크린샷 2022-11-03 오후 3.09.49.png](%E1%84%8C%E1%85%A1%E1%84%87%E1%85%A1%20%E1%84%80%E1%85%A1%E1%84%89%E1%85%A1%E1%86%BC%E1%84%86%E1%85%A5%E1%84%89%E1%85%B5%E1%86%AB%20JVM%20c828a64ae0bd423ea55d8d8bf3daea47/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2022-11-03_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.09.49.png)

자바로 .java 코드를 작성하고 파워쉘이나 터미널에 있는 자바 컴파일러인 javac에 컴파일 명령을 내리면 .class 파일이 만들어 집니다. 이후 이 바이트 코드는 클래스 로더를 통해 JVM Runtime Data Area로 로딩되고 로딩된 .class 바이트 코드를 실행한 컴퓨터에 깔린 JVM에 가져다주면 그 컴퓨터가 이 프로그램을 실행할 때 이 JVM이 그때그떄 기계어로 해석합니다.

## 바이트 코드를 읽는 방식

JVM은 바이트코드를 명령어 단위로 읽어서 해석하는데, Interpreter방식과 JIT 컴파일 방식 두 가지 방식을 혼합하여 사용합니다.

### Interpreter 방식

- 바이트코드를 한 줄씩 해석, 실행하는 방식
- 속도가 느리다는 단점이 존재

### JIT 컴파일러

기존의 자바는 인터프리터 방식으로 하였으나 속도가 느리다는 명확한 단점이 존재했습니다.

오늘날 하드웨어가 발전하면서 자바 컴파일러도 JIT 컴파일러 방식으로 개선되어 속도적인 측면에서 상당한 개선을 이루었습니다. JVM은 JIT(Just In Time) 컴파일러라고 합니다. 또한, JIT컴파일러는 같은 코드를 매번 해석하지 않고, 실행할 때 컴파일을 하면서 해당 코드를 캐싱해버립니다. 이후에는 바뀐 부분만 컴파일하고, 나머지는 캐싱된 코드를 사용합니다. 이렇게 JIT 컴파일러는 운영체제에 맞게 바이트 실행 코드로 한 번에 변환하여 실행되기 때문에 이전의 자바 해석기(Java interpreter)방식보다 성능이 10배 ~ 20배 정도 더 좋습니다.